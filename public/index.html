<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    
    <!-- PWA –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è -->
    <meta name="application-name" content="PotolokForLife">
    <meta name="apple-mobile-web-app-title" content="PotolokCalc">
    
    <!-- PWA —Ç–µ–º—ã -->
    <meta name="theme-color" content="#3498db" media="(prefers-color-scheme: light)">
    <meta name="theme-color" content="#2c3e50" media="(prefers-color-scheme: dark)">
    
    <!-- Apple PWA -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Microsoft PWA -->
    <meta name="msapplication-TileColor" content="#3498db">
    <meta name="msapplication-TileImage" content="/icon-144.png">
    <meta name="msapplication-config" content="/browserconfig.xml">
    
    <!-- PWA –º–∞–Ω–∏—Ñ–µ—Å—Ç -->
    <link rel="manifest" href="/manifest.json" crossorigin="use-credentials">
    
    <!-- –ò–∫–æ–Ω–∫–∏ -->
    <link rel="icon" type="image/png" sizes="32x32" href="/icon-32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="/icon-16.png">
    <link rel="apple-touch-icon" href="/icon-180.png">
    <link rel="mask-icon" href="/icon.svg" color="#3498db">
    
    <title>PotolokForLife - –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä –Ω–∞—Ç—è–∂–Ω—ã—Ö –ø–æ—Ç–æ–ª–∫–æ–≤</title>
</head>
<body>
    <noscript>
        <div style="text-align: center; padding: 50px;">
            <h1>–î–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Ç—Ä–µ–±—É–µ—Ç—Å—è JavaScript</h1>
            <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–∫–ª—é—á–∏—Ç–µ JavaScript –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –±—Ä–∞—É–∑–µ—Ä–∞</p>
        </div>
    </noscript>
    <div id="root"></div>
    
    <!-- PWA Service Worker -->
    <script>
        // –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                const swUrl = '/service-worker.js';
                
                navigator.serviceWorker.register(swUrl)
                    .then(registration => {
                        console.log('‚úÖ Service Worker –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω:', registration);
                        
                        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
                        registration.onupdatefound = () => {
                            const installingWorker = registration.installing;
                            if (installingWorker == null) return;
                            
                            installingWorker.onstatechange = () => {
                                if (installingWorker.state === 'installed') {
                                    if (navigator.serviceWorker.controller) {
                                        console.log('üîÑ –ù–æ–≤—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç –¥–æ—Å—Ç—É–ø–µ–Ω. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.');
                                    } else {
                                        console.log('‚úÖ –ö–æ–Ω—Ç–µ–Ω—Ç –∑–∞–∫—ç—à–∏—Ä–æ–≤–∞–Ω –¥–ª—è –æ—Ñ—Ñ–ª–∞–π–Ω —Ä–∞–±–æ—Ç—ã.');
                                    }
                                }
                            };
                        };
                    })
                    .catch(error => {
                        console.error('‚ùå –û—à–∏–±–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ Service Worker:', error);
                    });
            });
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞
        fetch('/manifest.json')
            .then(response => {
                if (!response.ok) throw new Error('HTTP error ' + response.status);
                return response.json();
            })
            .then(manifest => {
                console.log('‚úÖ Manifest –∑–∞–≥—Ä—É–∂–µ–Ω:', manifest.name);
                console.log('üìå PWA ID:', manifest.id);
                
                // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ PWA
                if (window.matchMedia('(display-mode: standalone)').matches) {
                    console.log('üì± –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ –≤ standalone —Ä–µ–∂–∏–º–µ');
                }
            })
            .catch(error => {
                console.warn('‚ö†Ô∏è Manifest –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω:', error.message);
            });
    </script>
</body>
</html>
